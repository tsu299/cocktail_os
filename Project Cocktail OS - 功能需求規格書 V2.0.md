## 1. 專案概述 (Project Overview)

- **產品定位：** 結合「公眾調酒百科」、「個人數位酒櫃」與「AI 靈感顧問」的混合型 Web 應用程式。
- **核心價值：**
    - **解決痛點：** 不知道喝什麼、家裡剩酒怎麼消、跑吧紀錄零散難查。
    - **差異化：** 透過「庫存匹配」與「AI 推薦」提供主動式服務，而非被動查詢。
- **目標載體：** 響應式網頁 (RWD Web)，優先優化手機端體驗 (Mobile First)。

## 2. 使用者角色 (User Roles)

1. **遊客 (Guest)：** 未登入。可瀏覽公開資訊、使用隨機骰子。
2. **會員 (Member)：** 已登入。擁有個人庫存、筆記、跑吧紀錄與 AI 推薦功能。
3. **管理員 (Admin)：** 系統維護、數據管理、邀請碼生成。

---

## 3. 功能模組詳解 (Functional Modules)

### 🟢 模組 A：身份與門禁系統 (Identity & Access)

*設計原則：極簡登入，邀請制控管。*

1. **第三方登入 (Social Login)：**
    - 僅支援 **Google** 與 **LINE** 登入。
    - 不實作傳統帳號/密碼註冊。
2. **邀請碼機制 (The Gatekeeper)：**
    - **邏輯：** 新帳號首次登入時，系統檢測無會員資料，強制跳轉至「輸入邀請碼」頁面。
    - **驗證：** 輸入正確且有效的邀請碼後，才建立會員檔案並放行。
    - **防護：** 針對邀請碼輸入接口設定頻率限制 (Rate Limit)，防止暴力破解。

### 🔵 模組 B：公開探索層 (Public Exploration)

*設計原則：SEO 友善，資訊結構化，具備遊戲性。*

1. **全域百科資料庫 (Wiki)：**
    - **經典酒譜：** 標準 IBA 或知名配方。顯示風味標籤、ABV 估算、製作難度。
    - **酒款/材料索引：** 基酒介紹 (如 Gin) 與常見品牌 (如 Hendrick's)。
    - **層級關聯：** 系統需識別「Hendrick's (子) 屬於 Gin (父)」，以利搜尋與推薦。
2. **靈感骰子 (The Randomizer)：**
    - **好手氣模式：** 一鍵隨機推薦一杯調酒。
    - **條件篩選模式：** 指定「基酒」、「風味(酸/甜/苦)」、「情境」後進行隨機抽選。
    - **權重邏輯：** 隨機演算法應略微偏向「熱門/高分」配方，避免推薦冷門雷品。
3. **公開店家指南 (Bar Directory)：**
    - 基礎店家列表（名稱、區域、風格標籤）。

### 🟣 模組 C：個人管理層 (Personal Management)

*設計原則：數據私有化，高度客製化。*

1. **我的數位吧台 (My Bar / Inventory)：**
    - **庫存管理：** 使用者勾選擁有的酒。支援「模糊登記」(只選 Gin) 與「精確登記」(選 Tanqueray No.10)。
    - **購物清單 (Wishlist)：** 將缺少的材料加入清單。
2. **調製與品飲日記 (Tasting Journal)：**
    - **Type 1 - 經典複刻：** 引用公開酒譜，紀錄評分 (1-5星)、心得、實際使用材料。
    - **Type 2 - 自創簽名 (Signature)：** 完整編輯器，紀錄自創酒譜的步驟與比例，可設為公開/私人。
    - **Type 3 - 隨手特調 (Freestyle)：** 極簡紀錄模式。僅需「文字描述」+「照片」，不強制關聯酒譜資料。
3. **個人數據儀表板 (Stats)：**
    - 顯示飲用偏好分析 (如：60% 喜歡威士忌基底)。
    - 活躍度圖表 (Contribution Graph)。

### 🟠 模組 D：跑吧與生活層 (Bar Hopping)

*設計原則：私人備忘錄，連結線下體驗。*

1. **跑吧日記 (Visit Logs)：**
    - **打卡：** 紀錄日期、店家。
    - **飲用紀錄：** 純文字輸入喝了什麼 (因店家特調未必在資料庫內)。
    - **消費紀錄：** (選填) 金額。
2. **私房店家筆記：**
    - **收藏店家：** 加入口袋名單。
    - **私人評價：** 撰寫只有自己能看到的筆記 (如：調酒師評價、座位喜好)。
    - **到訪統計：** 系統自動計算去過某店家的次數並排序。

### ✨ 模組 E：AI 智慧層 (The Brain)

*設計原則：主動式服務，解決「能做什麼」。*

1. **智慧庫存推薦 (What can I make?)：**
    - 比對 `My Inventory` 與 `Recipes`。
    - 顯示：「你可以做這些」、「你只差一顆檸檬就能做這些」。
2. **AI 靈感生成 (Copilot)：**
    - **情境生成：** 使用者輸入心情或模糊需求，AI 生成推薦或創意酒譜。
    - **清庫存建議：** 針對使用者指定的剩餘材料，提供調製建議。

---

## 4. 資料與系統架構 (System Architecture)

### 資料庫核心邏輯 (Schema Highlights)

- **Ontology (本體論) 設計：** `Ingredients` 表必須具備 `parent_id` 欄位，以處理「酒類層級繼承」關係。
- **使用者隔離：** 除了公開 Wiki 外，所有 Inventory、Log、Rating 資料皆需綁定 `user_id`，確保隱私。

### 安全性需求 (Security)

- 全站強制 HTTPS。
- API 權限驗證：所有寫入與讀取個人資料的 API 需驗證 Token。
- 邀請碼 Rate Limiting：防止腳本暴力嘗試。

---

## 5. 開發階段規劃 (Phasing)

- **Phase 1 (MVP):**
    - 完成 Google/LINE 登入 + 邀請碼系統。
    - 建置基礎公開資料庫 (Wiki) 與後台管理。
    - 完成「我的庫存」與「經典複刻」紀錄功能。
- **Phase 2 (Growth):**
    - 上線「靈感骰子」。
    - 上線「跑吧日記」。
    - 接入 AI API 實作推薦功能。
- **Phase 3 (Optimization):**
    - 數據儀表板。
    - 進階社群功能 (如分享自創酒譜)。