## 1. ç³»çµ±æ¶æ§‹æ¦‚è¦½ (System Architecture)

æ¡ç”¨ **CSR (Client-Side Rendering)** å‰å¾Œç«¯åˆ†é›¢æ¶æ§‹ï¼Œé€é RESTful API æºé€šã€‚

- **å‰ç«¯ (Client):** è² è²¬ç•«é¢æ¸²æŸ“ã€è·¯ç”±ã€ç‹€æ…‹ç®¡ç†ã€èˆ‡ Firebase/OAuth äº’å‹•ã€‚
- **å¾Œç«¯ (Server):** è² è²¬å•†æ¥­é‚è¼¯ã€è³‡æ–™åº«å­˜å– (Prisma)ã€AI API è½‰ç™¼ã€æ¬Šé™æ§ç®¡ (Middleware)ã€‚
- **è³‡æ–™åº« (Data):** å„²å­˜é—œè¯å¼è³‡æ–™ï¼ˆé…’è­œã€åº«å­˜ã€æ—¥èªŒï¼‰ã€‚
- **å¤–éƒ¨æœå‹™ (External):** Google/LINE (èº«ä»½é©—è­‰), OpenAI (AI æ¨ç†).

---

## 2. é–‹ç™¼ç’°å¢ƒéœ€æ±‚ (Local Development Environment)

åœ¨é–‹å§‹å¯« code ä¹‹å‰ï¼Œè«‹ç¢ºä¿é–‹ç™¼æ©Ÿï¼ˆä½ çš„é›»è…¦ï¼‰å®‰è£ä»¥ä¸‹å·¥å…·ï¼š

| **å·¥å…·** | **å»ºè­°ç‰ˆæœ¬** | **ç”¨é€”** |
| --- | --- | --- |
| **Node.js** | **v20.x (LTS)** | åŸ·è¡Œç’°å¢ƒ (å»ºè­°ä½¿ç”¨ nvm ç®¡ç†) |
| **Package Manager** | **npm** (v10+) | å¥—ä»¶ç®¡ç† (ä¹Ÿå¯é¸ pnpm é€Ÿåº¦è¼ƒå¿«) |
| **Database** | **MariaDB 10.6+** | æœ¬åœ°è³‡æ–™åº« (éœ€æ”¯æ´ Window Functions) |
| **IDE** | **VS Code** | ç¨‹å¼ç·¨è¼¯å™¨ |
| **VS Code å¥—ä»¶** | Prisma, ESLint, Prettier, Tailwind CSS | æå‡é–‹ç™¼æ•ˆç‡èˆ‡èªæ³•æª¢æŸ¥ |
| **Git** | æœ€æ–°ç‰ˆ | ç‰ˆæœ¬æ§åˆ¶ |

---

## 3. æŠ€è¡“å †ç–Šè©³æƒ… (Tech Stack Specifications)

### ğŸ…°ï¸ å‰ç«¯ (Frontend)

- **èªè¨€:** **TypeScript** (å¼·çƒˆå»ºè­°ï¼Œé¿å…å‹åˆ¥éŒ¯èª¤)
- **æ ¸å¿ƒæ¡†æ¶:** **React 18**
- **å»ºç½®å·¥å…·:** **Vite** (ç§’é–‹ç´šçš„é–‹ç™¼é«”é©—)
- **UI æ¡†æ¶:** **Tailwind CSS** (æ¨£å¼) + **Shadcn UI** (ç¾æˆçš„é«˜è³ªæ„Ÿå…ƒä»¶åº«)
- **ç‹€æ…‹èˆ‡å¿«å–:** **TanStack Query (React Query)** (è™•ç† API å¿«å–èˆ‡è‡ªå‹•æ›´æ–°)
- **è·¯ç”±:** **React Router v6**
- **åœ–ç¤ºåº«:** **Lucide React** (é¢¨æ ¼çµ±ä¸€çš„ Icon)

### ğŸ…±ï¸ å¾Œç«¯ (Backend API)

- **èªè¨€:** **TypeScript** (Node.js)
- **Web æ¡†æ¶:** **Express.js** (ä½ æœ€ç†Ÿæ‚‰çš„)
- **ORM (è³‡æ–™åº«å°æ‡‰):** **Prisma** (æ ¸å¿ƒå‡ç´šï¼å–ä»£æ‰‹å¯« SQL)
- **é©—è­‰:** **Firebase Admin SDK** æˆ– **Passport.js** (è™•ç† Token é©—è­‰)
- **åœ–ç‰‡è™•ç†:** **Multer** (ä¸Šå‚³) + **Sharp** (å£“ç¸®èˆ‡è½‰æª” WebP)
- **AI æ•´åˆ:** **OpenAI Node.js SDK**

### ğŸ—„ï¸ è³‡æ–™åº« (Database)

- **DBMS:** **MariaDB** (å»ºè­° 10.6 æˆ– 10.11 LTS)
- **ç·¨ç¢¼ (Collation):** `utf8mb4_unicode_ci` (æ”¯æ´ Emoji èˆ‡ç¹é«”ä¸­æ–‡æ’åº)
- **å¼•æ“:** InnoDB

---

## 4. é—œéµå¥—ä»¶èˆ‡ä¾è³´ (Key Dependencies)

é€™æ˜¯åœ¨ `package.json` ä¸­æœƒå‡ºç¾çš„é—œéµä¸»è§’ï¼š

### Frontend (`client/package.json`)

JSON

`{
  "dependencies": {
    "react": "^18.2.0",
    "react-router-dom": "^6.x",
    "@tanstack/react-query": "^5.x",
    "axios": "^1.x",
    "clsx": "^2.x",            // ç”¨æ–¼å‹•æ…‹ class åˆä½µ
    "tailwind-merge": "^2.x",  // Shadcn UI ä¾è³´
    "lucide-react": "^0.x",
    "framer-motion": "^10.x"   // (é¸ç”¨) ç”¨æ–¼éª°å­å‹•ç•«
  },
  "devDependencies": {
    "typescript": "^5.x",
    "vite": "^5.x",
    "tailwindcss": "^3.x",
    "@types/node": "^20.x"
  }
}`

### Backend (`server/package.json`)

JSON

`{
  "dependencies": {
    "express": "^4.18.x",
    "cors": "^2.8.5",
    "dotenv": "^16.x",
    "helmet": "^7.x",
    "@prisma/client": "^5.x",  // Prisma å®¢æˆ¶ç«¯
    "zod": "^3.x",             // å¼·å¤§çš„è³‡æ–™é©—è­‰åº« (æ­é… TS ç”¨)
    "jsonwebtoken": "^9.x",    // è™•ç† Session Token
    "multer": "^1.4.x",
    "sharp": "^0.33.x",
    "openai": "^4.x"
  },
  "devDependencies": {
    "typescript": "^5.x",
    "prisma": "^5.x",          // Prisma CLI å·¥å…·
    "ts-node": "^10.x",        // é–‹ç™¼æ™‚ç›´æ¥è·‘ TS
    "nodemon": "^3.x"
  }
}`

---

## 5. ç’°å¢ƒè®Šæ•¸è¦ç¯„ (.env)

é€™æ˜¯è³‡å®‰çš„é‡é»ï¼Œ**çµ•å°ä¸è¦ä¸Šå‚³åˆ° GitHub**ã€‚

### å¾Œç«¯ `.env` ç¯„ä¾‹

Ini, TOML

`# Server Config
PORT=3000
NODE_ENV=development

# Database (Prisma æ ¼å¼)
# æ ¼å¼: mysql://USER:PASSWORD@HOST:PORT/DATABASE
DATABASE_URL="mysql://admin:password123@localhost:3306/cocktail_os"

# Authentication (JWT Secret or Firebase)
JWT_SECRET="super_long_random_string_for_security"
# å¦‚æœç”¨ Firebase Admin
FIREBASE_SERVICE_ACCOUNT_PATH="./config/firebase-admin.json"

# OAuth Credentials (ç”¨æ–¼å¾Œç«¯æ›å– Token)
GOOGLE_CLIENT_ID="xxx"
GOOGLE_CLIENT_SECRET="xxx"
LINE_CHANNEL_ID="xxx"
LINE_CHANNEL_SECRET="xxx"

# AI Service
OPENAI_API_KEY="sk-xxxxxxxxxxxxxxxx"`

---

## 6. éƒ¨ç½²æ¶æ§‹ (Deployment on Ubuntu)

é€™éƒ¨åˆ†èˆ‡ä½ çš„ã€Œåœè»ŠåŠ©æ‰‹ã€å¹¾ä¹ä¸€è‡´ï¼Œé™ä½ç¶­é‹å­¸ç¿’æˆæœ¬ã€‚

1. **Web Server:** **Nginx**
    - è² è²¬ Reverse Proxy (`/api` è½‰çµ¦ Express, å…¶ä»–è½‰çµ¦ React build æª”æ¡ˆ)ã€‚
    - è² è²¬ SSL æ†‘è­‰ (Let's Encrypt / Certbot)ã€‚
    - é–‹å•Ÿ Gzip å£“ç¸®ä»¥åŠ é€Ÿè¼‰å…¥ã€‚
2. **Process Manager:** **PM2**
    - ç”¨ä¾†è·‘å¾Œç«¯ï¼š`pm2 start dist/index.js --name "cocktail-api"`ã€‚
    - ç¢ºä¿ç•¶æ©Ÿè‡ªå‹•é‡å•Ÿã€‚
3. **Build Process (CI/CD æ¦‚å¿µ):**
    - **Backend:** `tsc` (å°‡ TypeScript ç·¨è­¯æˆ JavaScript) -> PM2 Reloadã€‚
    - **Frontend:** `vite build` (ç”¢ç”Ÿ `/dist` è³‡æ–™å¤¾) -> è¤‡è£½åˆ° Nginx éœæ…‹ç›®éŒ„ã€‚

---

## 7. å°ˆæ¡ˆç›®éŒ„çµæ§‹å»ºè­° (Project Structure)

å»ºè­°æ¡ç”¨ **Monorepo** é¢¨æ ¼ï¼ˆé›–ç„¶ä¸ä¸€å®šè¦ç”¨ TurboRepoï¼Œä½†æŠŠå‰å¾Œç«¯æ”¾åœ¨åŒä¸€å€‹ Git Repo ä¸åŒè³‡æ–™å¤¾ç®¡ç†ï¼‰ã€‚

Plaintext

`cocktail-os/
â”œâ”€â”€ client/                 # å‰ç«¯ (React + Vite)
â”‚   â”œâ”€â”€ src/
â”‚   â”‚   â”œâ”€â”€ components/     # UI å…ƒä»¶ (Shadcn æ”¾åœ¨é€™)
â”‚   â”‚   â”œâ”€â”€ hooks/          # Custom Hooks (API å‘¼å«é‚è¼¯)
â”‚   â”‚   â”œâ”€â”€ pages/          # é é¢ (Home, Inventory, Recipe)
â”‚   â”‚   â””â”€â”€ lib/            # å·¥å…·å‡½å¼ (utils.ts)
â”‚   â”œâ”€â”€ package.json
â”‚   â””â”€â”€ tsconfig.json
â”‚
â”œâ”€â”€ server/                 # å¾Œç«¯ (Express)
â”‚   â”œâ”€â”€ prisma/
â”‚   â”‚   â””â”€â”€ schema.prisma   # âœ¨ è³‡æ–™åº«å®šç¾©æª” (æœ€é‡è¦!)
â”‚   â”œâ”€â”€ src/
â”‚   â”‚   â”œâ”€â”€ controllers/    # è™•ç† Request/Response
â”‚   â”‚   â”œâ”€â”€ middleware/     # é©—è­‰ Auth, RateLimit
â”‚   â”‚   â”œâ”€â”€ routes/         # å®šç¾© API è·¯å¾‘
â”‚   â”‚   â””â”€â”€ services/       # è¤‡é›œé‚è¼¯ (å¦‚åº«å­˜åŒ¹é…ç®—æ³•)
â”‚   â”œâ”€â”€ uploads/            # åœ–ç‰‡å­˜å„²å€
â”‚   â”œâ”€â”€ package.json
â”‚   â””â”€â”€ tsconfig.json
â”‚
â””â”€â”€ README.md`